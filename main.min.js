var posxHead=0,posyHead=0,posxApple=0,posyApple=0,time=0;const increment=40;let numy=(window.innerHeight-window.innerHeight%20)/20-(.3*window.innerHeight-window.innerHeight%20)/20,numx=(window.innerWidth-window.innerWidth%20)/20-(.22*window.innerWidth-window.innerHeight%20)/20;var backGround,highScore,fieldHeight=Math.floor(numy),fieldWidth=Math.floor(numx),listx=[],listy=[],thisx=0,thisy=0,lastkey="",intervals=[],snakeLen=0;function changeSize(e){e.matches&&(fieldWidth=40,increment=60)}null==localStorage.getItem("highScore")?(highScore=0,localStorage.setItem("highScore",highScore)):highScore=localStorage.getItem("highScore");var started=!1;function wait(e){const t=Date.now();let a=null;do{a=Date.now()}while(a-t<e)}function clear(e){background.removeClass(e)}function applePos(e,t){$("."+e.toString()+"-"+t.toString()).addClass("apple")}function headPos(e,t){$("."+e.toString()+"-"+t.toString()).addClass("head")}function mainHeadPos(e,t){clear("mainHead"),posxHead=e,posyHead=t,$("."+e.toString()+"-"+t.toString()).addClass("mainHead"),$("."+e.toString()+"-"+t.toString()).removeClass("head")}function randApple(){for($("."+posxApple.toString()+"-"+posyApple.toString()).removeClass("apple"),posxApple=Math.round(Math.random()*(fieldWidth-1)+1),posyApple=Math.round(Math.random()*(fieldHeight-1)+1);$("."+posxApple.toString()+"-"+posyApple.toString()).hasClass("head");)posxApple=Math.round(Math.random()*(fieldWidth-1)+1),posyApple=Math.round(Math.random()*(fieldHeight-1)+1);applePos(posxApple,posyApple)}function chart(e,t,a){var n;for(listx.unshift(e),listy.unshift(t),n=0;n<=a;n++)$("."+listx[a-n].toString()+"-"+listy[a-n].toString()).addClass("head");$("."+listx[a+1].toString()+"-"+listy[a+1].toString()).removeClass("head")}posxHead=Math.round(Math.random()*(fieldWidth-1)+1),posyHead=Math.round(Math.random()*(fieldHeight-1)+1);const bodyIncrement=3;function checkScore(){snakeLen>highScore&&(highScore=snakeLen,localStorage.setItem("highScore",highScore)),document.getElementById("highscore").innerHTML="High Score: "+(highScore/bodyIncrement).toString(),document.getElementById("score").innerHTML="Score: "+(snakeLen/bodyIncrement).toString()}const start=()=>{if(0==time)for(var e=1;e<=fieldWidth;e++){$("#mainRow").append('<div class = "col col-'+e.toString()+'"></div>');for(var t=1;t<=fieldHeight;t++)$(".col-"+e.toString()).append('<span class = "blockGround '+e.toString()+"-"+t.toString()+'"></span>')}background=$(".blockGround"),background.removeClass("head").removeClass("mainHead"),listx=[0,1],listy=[0,1],intervals.forEach(window.clearInterval),randApple(),$("."+posxHead.toString()+"-"+posyHead.toString()).removeClass("head"),$("."+posxHead.toString()+"-"+posyHead.toString()).removeClass("mainHead"),posxHead=Math.round(Math.random()*(fieldWidth-1)+1),posyHead=Math.round(Math.random()*(fieldHeight-1)+1),headPos(posxHead,posyHead),started=!0,snakeLen=0,checkScore(),time++},isTouching=()=>{var e;return $("."+posxHead.toString()+"-"+posyHead.toString()).hasClass("mainHead")&&$("."+posxHead.toString()+"-"+posyHead.toString()).hasClass("head")&&(e=!0),e},appleTouched=()=>{snakeLen+=bodyIncrement,checkScore(),randApple()},isGameOver=()=>(posxHead>fieldWidth||posxHead<=0||posyHead>=fieldHeight+1||posyHead<=0||isTouching())&&snakeLen!==fieldHeight*fieldWidth,endGame=()=>{start()};class arrows{static left(){isGameOver()&&endGame(),$("."+(posxApple+1).toString()+"-"+posyApple.toString()).hasClass("mainHead")&&appleTouched(),lastkey="left",thisx=posxHead,thisy=posyHead,mainHeadPos(posxHead-=1,posyHead),chart(thisx,thisy,snakeLen)}static right(){isGameOver()&&endGame(),$("."+(posxApple-1).toString()+"-"+posyApple.toString()).hasClass("mainHead")&&appleTouched(),thisx=posxHead,thisy=posyHead,lastkey="right",mainHeadPos(posxHead+=1,posyHead),chart(thisx,thisy,snakeLen)}static up(){isGameOver()&&endGame(),$("."+posxApple.toString()+"-"+(posyApple+1).toString()).hasClass("mainHead")&&appleTouched(),thisx=posxHead,thisy=posyHead,lastkey="up",mainHeadPos(posxHead,posyHead-=1),chart(thisx,thisy,snakeLen)}static down(){isGameOver()&&endGame(),$("."+posxApple.toString()+"-"+(posyApple-1).toString()).hasClass("mainHead")&&appleTouched(),lastkey="down",thisx=posxHead,thisy=posyHead,mainHeadPos(posxHead,posyHead+=1),chart(thisx,thisy,snakeLen)}}function end(){started=!started}function keydown(e){var t=e.key;if(" "===t&&start(),started)if(snakeLen===fieldHeight*fieldWidth)window.alert("You Won! Congratulations");else if("ArrowLeft"!=t&&"a"!=t||"right"===lastkey&&0!==snakeLen)if("ArrowRight"!=t&&"d"!=t||"left"===lastkey&&0!==snakeLen)if("ArrowUp"!=t&&"w"!=t||"down"===lastkey&&0!==snakeLen){if(!("ArrowDown"!=t&&"s"!=t||"up"===lastkey&&0!==snakeLen)){intervals.forEach(window.clearInterval);var a=window.setInterval(arrows.down,increment);intervals.push(a)}}else{intervals.forEach(window.clearInterval);var n=window.setInterval(arrows.up,increment);intervals.push(n)}else{intervals.forEach(window.clearInterval);var o=window.setInterval(arrows.right,increment);intervals.push(o)}else{intervals.forEach(window.clearInterval);var i=window.setInterval(arrows.left,increment);intervals.push(i)}}window.addEventListener("keydown",keydown);
